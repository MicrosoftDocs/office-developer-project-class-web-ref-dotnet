<Type Name="Archive" FullName="WebSvcArchive.Archive">
  <TypeSignature Language="C#" Value="public class Archive : System.Web.Services.Protocols.SoapHttpClientProtocol" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit Archive extends System.Web.Services.Protocols.SoapHttpClientProtocol" />
  <TypeSignature Language="DocId" Value="T:WebSvcArchive.Archive" />
  <TypeSignature Language="VB.NET" Value="Public Class Archive&#xA;Inherits SoapHttpClientProtocol" />
  <TypeSignature Language="C++ CLI" Value="public ref class Archive : System::Web::Services::Protocols::SoapHttpClientProtocol" />
  <TypeSignature Language="F#" Value="type Archive = class&#xA;    inherit SoapHttpClientProtocol" />
  <AssemblyInfo>
    <AssemblyName>ProjectServerServices</AssemblyName>
    <AssemblyVersion>0.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Web.Services.Protocols.SoapHttpClientProtocol</BaseTypeName>
  </Base>
  <Interfaces />
  <Attributes>
    <Attribute>
      <AttributeName>System.Web.Services.WebServiceBinding(Name="ArchiveSoap", Namespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/")</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary>Includes methods for managing backup and restore operations by using the Archive database in Project Server.</summary>
    <remarks>
      <para>The <b>Archive</b> class includes the following kinds of archival methods:</para>
      <list type="bullet">
        <item>
          <description>Allows a user to manage interactions between active projects and archived projects.</description>
        </item>
        <item>
          <description>Allows a user to set scheduling information for archive operations.</description>
        </item>
        <item>
          <description>Allows a user to determine archive retention parameters.</description>
        </item>
      </list>
      <para>The Project Server Archive pages in Project Web App use many of the <b>Archive</b> class methods. If you have administrator permission, click Server Settings in Project Web App.</para>
      <para>The following methods are located in other PSI web services:</para>
      <list type="bullet">
        <item>
          <description>For administration functions, see the <see cref="T:WebSvcAdmin.Admin" /> class.</description>
        </item>
        <item>
          <description>For managing permissions, see the <see cref="T:WebSvcSecurity.Security" /> class.</description>
        </item>
        <item>
          <description>For managing Project Server event handler associations, see the <see cref="T:WebSvcEvents.Events" /> class.</description>
        </item>
        <item>
          <description>For managing SharePoint sites for projects, see the <see cref="T:WebSvcWssInterop.WssInterop" /> class.</description>
        </item>
      </list>
      <para />
    </remarks>
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public Archive ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:WebSvcArchive.Archive.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; Archive();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>ProjectServerServices</AssemblyName>
        <AssemblyVersion>0.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary>Creates an <b>Archive</b> object from the ASMX-based <b>Archive</b> web service.</summary>
        <remarks>
          <para>To create an object that is equivalent to <b>Archive</b> by using the Windows Communication Foundation (WCF) API, use one of the <b>ArchiveClient</b> constructors.</para>
          <para />
        </remarks>
        <example>
          <para>In the following statement, <b>ArchiveWebSvc</b> is an arbitrary namespace for the ASMX-based <b>Archive</b> web service.</para>
          <code>private static ArchiveWebSvc.Archive archive = new ArchiveWebSvc.Archive();</code>
          <para>In the following statement, <b>SvcArchive</b> is an arbitrary namespace for the WCF-based <b>Archive</b> service. The <paramref name="endpt" /> parameter is a <b>String</b> value that specifies the name of the client endpoint address in the app.config file (or in the web.config file for web applications).</para>
          <code>private static SvcArchive.ArchiveClient archiveClient = new SvcArchive.ArchiveClient(endpt);</code>
        </example>
      </Docs>
    </Member>
    <Member MemberName="QueueArchiveCategories">
      <MemberSignature Language="C#" Value="public void QueueArchiveCategories (Guid jobUID);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void QueueArchiveCategories(valuetype System.Guid jobUID) cil managed" />
      <MemberSignature Language="DocId" Value="M:WebSvcArchive.Archive.QueueArchiveCategories(System.Guid)" />
      <MemberSignature Language="VB.NET" Value="Public Sub QueueArchiveCategories (jobUID As Guid)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void QueueArchiveCategories(Guid jobUID);" />
      <MemberSignature Language="F#" Value="member this.QueueArchiveCategories : Guid -&gt; unit" Usage="archive.QueueArchiveCategories jobUID" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>ProjectServerServices</AssemblyName>
        <AssemblyVersion>0.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Web.Services.Protocols.SoapDocumentMethod("http://schemas.microsoft.com/office/project/server/webservices/Archive/QueueArchiveCategories", ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped, RequestNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", ResponseNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", Use=System.Web.Services.Description.SoapBindingUse.Literal)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="jobUID" Type="System.Guid" />
      </Parameters>
      <Docs>
        <param name="jobUID">The GUID of the queue job.</param>
        <summary>Saves a copy of tables for security categories from the Published database to the Archive database.</summary>
        <remarks>
          <para>
            <b>QueueArchiveCategories</b> is an asynchronous method that sends a message to the Project Server Queuing Service.</para>
          <para>Project Server Permissions</para>
          <list type="table">
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerBackup" />
              </term>
              <description>Allows a user to schedule or perform a backup of Project Server entities. Global permission.</description>
            </item>
          </list>
          <para />
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="QueueArchiveCustomFields">
      <MemberSignature Language="C#" Value="public void QueueArchiveCustomFields (Guid jobUID);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void QueueArchiveCustomFields(valuetype System.Guid jobUID) cil managed" />
      <MemberSignature Language="DocId" Value="M:WebSvcArchive.Archive.QueueArchiveCustomFields(System.Guid)" />
      <MemberSignature Language="VB.NET" Value="Public Sub QueueArchiveCustomFields (jobUID As Guid)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void QueueArchiveCustomFields(Guid jobUID);" />
      <MemberSignature Language="F#" Value="member this.QueueArchiveCustomFields : Guid -&gt; unit" Usage="archive.QueueArchiveCustomFields jobUID" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>ProjectServerServices</AssemblyName>
        <AssemblyVersion>0.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Web.Services.Protocols.SoapDocumentMethod("http://schemas.microsoft.com/office/project/server/webservices/Archive/QueueArchiveCustomFields", ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped, RequestNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", ResponseNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", Use=System.Web.Services.Description.SoapBindingUse.Literal)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="jobUID" Type="System.Guid" />
      </Parameters>
      <Docs>
        <param name="jobUID">The GUID of the queue job.</param>
        <summary>Saves a copy of tables for enterprise custom fields from the Published database to the Archive database.</summary>
        <remarks>
          <para>
            <b>QueueArchiveCustomFields</b> is an asynchronous method that sends a message to the Project Server Queuing Service.</para>
          <para>Project Server Permissions</para>
          <list type="table">
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerBackup" />
              </term>
              <description>Allows a user to schedule or perform a backup of Project Server entities. Global permission.</description>
            </item>
          </list>
          <para />
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="QueueArchiveGlobalProject">
      <MemberSignature Language="C#" Value="public void QueueArchiveGlobalProject (Guid jobUID);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void QueueArchiveGlobalProject(valuetype System.Guid jobUID) cil managed" />
      <MemberSignature Language="DocId" Value="M:WebSvcArchive.Archive.QueueArchiveGlobalProject(System.Guid)" />
      <MemberSignature Language="VB.NET" Value="Public Sub QueueArchiveGlobalProject (jobUID As Guid)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void QueueArchiveGlobalProject(Guid jobUID);" />
      <MemberSignature Language="F#" Value="member this.QueueArchiveGlobalProject : Guid -&gt; unit" Usage="archive.QueueArchiveGlobalProject jobUID" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>ProjectServerServices</AssemblyName>
        <AssemblyVersion>0.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Web.Services.Protocols.SoapDocumentMethod("http://schemas.microsoft.com/office/project/server/webservices/Archive/QueueArchiveGlobalProject", ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped, RequestNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", ResponseNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", Use=System.Web.Services.Description.SoapBindingUse.Literal)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="jobUID" Type="System.Guid" />
      </Parameters>
      <Docs>
        <param name="jobUID">The GUID of the queue job.</param>
        <summary>Saves a copy of the enterprise global project from the Published database to the Archive database.</summary>
        <remarks>
          <para>
            <b>QueueArchiveGlobalProject</b> is an asynchronous method that sends a message to the Project Server Queuing Service.</para>
          <para>Project Server Permissions</para>
          <list type="table">
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerBackup" />
              </term>
              <description>Allows a user to schedule or perform a backup of Project Server entities. Global permission.</description>
            </item>
          </list>
          <para />
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="QueueArchiveProject">
      <MemberSignature Language="C#" Value="public Guid QueueArchiveProject (Guid jobUID, Guid projectUID, Guid archivedProjectUID, string versionDescription, int retentionPolicy, bool permanentArchive);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance valuetype System.Guid QueueArchiveProject(valuetype System.Guid jobUID, valuetype System.Guid projectUID, valuetype System.Guid archivedProjectUID, string versionDescription, int32 retentionPolicy, bool permanentArchive) cil managed" />
      <MemberSignature Language="DocId" Value="M:WebSvcArchive.Archive.QueueArchiveProject(System.Guid,System.Guid,System.Guid,System.String,System.Int32,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Function QueueArchiveProject (jobUID As Guid, projectUID As Guid, archivedProjectUID As Guid, versionDescription As String, retentionPolicy As Integer, permanentArchive As Boolean) As Guid" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; Guid QueueArchiveProject(Guid jobUID, Guid projectUID, Guid archivedProjectUID, System::String ^ versionDescription, int retentionPolicy, bool permanentArchive);" />
      <MemberSignature Language="F#" Value="member this.QueueArchiveProject : Guid * Guid * Guid * string * int * bool -&gt; Guid" Usage="archive.QueueArchiveProject (jobUID, projectUID, archivedProjectUID, versionDescription, retentionPolicy, permanentArchive)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>ProjectServerServices</AssemblyName>
        <AssemblyVersion>0.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Web.Services.Protocols.SoapDocumentMethod("http://schemas.microsoft.com/office/project/server/webservices/Archive/QueueArchiveProject", ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped, RequestNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", ResponseNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", Use=System.Web.Services.Description.SoapBindingUse.Literal)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Guid</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="jobUID" Type="System.Guid" />
        <Parameter Name="projectUID" Type="System.Guid" />
        <Parameter Name="archivedProjectUID" Type="System.Guid" />
        <Parameter Name="versionDescription" Type="System.String" />
        <Parameter Name="retentionPolicy" Type="System.Int32" />
        <Parameter Name="permanentArchive" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="jobUID">The GUID of the queue job.</param>
        <param name="projectUID">The GUID of the project to archive.</param>
        <param name="archivedProjectUID">The GUID of the archived project.</param>
        <param name="versionDescription">The description of the project version.</param>
        <param name="retentionPolicy">Specifies the retention policy; values can be <b>-2</b>, <b>-1</b>, <b>0</b>, or <b>greater than 0</b>. </param>
        <param name="permanentArchive">Set <b>true</b> to maintain a permanent copy and avoid accidental deletion.</param>
        <summary>Saves a copy of the specified project from the Published database to the Archive database, and creates a version of the project.</summary>
        <returns>Returns a GUID for the project version.</returns>
        <remarks>
          <para>
            <b>QueueArchiveProject</b> is an asynchronous method that sends a message to the Project Server Queuing Service.</para>
          <para>Following are the values for retention policy.</para>
          <list type="table">
            <item>
              <term>&gt; 0</term>
              <description>Set the project retention policy; override the Project Server default retention policy.</description>
            </item>
            <item>
              <term>0</term>
              <description>Unlimited retention. Archive the project and do not check for retention delete.</description>
            </item>
            <item>
              <term>-1</term>
              <description>Use the project policy if it is set; otherwise, use the Project Server default.</description>
            </item>
            <item>
              <term>-2</term>
              <description>Use the Project Server default retention policy and clear the project retention policy.</description>
            </item>
          </list>
          <para>Save the returned project version GUID to use with <b>QueueRestoreProject</b>.</para>
          <para>Project Server Permissions</para>
          <list type="table">
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerBackup" />
              </term>
              <description>Allows a user to schedule or perform a backup of Project Server entities. Global permission.</description>
            </item>
          </list>
          <para />
        </remarks>
        <example>
          <para>The following code saves a copy of the specified project from the Published database to the Archived database, and retrieves the list of archived projects.</para>
          <para>For information about running this code sample, see Prerequisites for WCF-Based Code Samples.</para>
          <code>
using System;
using System.IO;
using System.ServiceModel;
using System.Text;
using PSLibrary = Microsoft.Office.Project.Server.Library;

namespace Microsoft.SDK.Project.Samples.ReadArchivedProjectsList
{
  class Program
  {
    private const string ENDPOINT = "basicHttp_Archive";
    private const string ENDPOINT_Q = "basicHttp_QueueSystem";
    private const string VERSION_DESCRIPTION = "2010-01-19 14:52:30";
    private const string PID = "56B5C90D-28C0-42A1-A2CF-8BC205F062BA";
    private const string OUTPUT_FILES = @"C:\Projects\Samples\Output\";

    private const int RETENTION_POLICY = -2;

    private static SvcArchive.ArchiveClient archiveClient;
    private static SvcQueueSystem.QueueSystemClient queueSystemClient;
    private static string outFilePath;

    private static int numProjects;

    static void Main1(string[] args)
    {
      try
      {
        Guid jobUID = Guid.NewGuid();
        Guid projectUID = new Guid(PID);
        Guid archivedProjectUID = Guid.NewGuid();
        DateTime startTime = DateTime.Now;
        numProjects = 1;

        // Use the endpoints that are defined in app.config to configure the client.
        SetClientEndpoints(ENDPOINT_Q);
        ConfigClientEndpoints(ENDPOINT);

        // If the directory does not exist, create it.
        if (!Directory.Exists(OUTPUT_FILES))
        {
          Directory.CreateDirectory(OUTPUT_FILES);
        }
        // Assign the path where the output XML file will be saved.
        outFilePath = OUTPUT_FILES + "ArchivedProjectsList.xml";

        // Queue the archive project.
        Guid projectVersionUID = archiveClient.QueueArchiveProject(
          jobUID, projectUID, archivedProjectUID, VERSION_DESCRIPTION, RETENTION_POLICY, true);

        Helpers.WaitForQueue(SvcQueueSystem.QueueMsgType.ProjectArchive, numProjects,
          queueSystemClient, startTime);

        Console.WriteLine("Projects archived successfully");

        Console.WriteLine("Retrieving the list of archived projects...");

        // Create a dataset.
        SvcArchive.ArchivedProjectsDataSet archivedProjectsDs =
            new SvcArchive.ArchivedProjectsDataSet();

        // Assign the datasource to the dataset.
        archivedProjectsDs = archiveClient.ReadArchivedProjectsList();
        archivedProjectsDs.WriteXml(outFilePath);

        // Get the count of projects.
        Console.WriteLine("Number of archived projects: {0}",
            archivedProjectsDs.Projects.Count.ToString());
        archiveClient.Close();

        // Write the list of projects to an XML file.
        Console.WriteLine("\nSee XML output of the ArchivedProjectsDataSet at {0}",
            outFilePath);
      }
      catch (CommunicationException e)
      {
        Console.ForegroundColor = ConsoleColor.Red;
        Console.WriteLine("\n***System.ServiceModel.CommunicationException:");
        Console.WriteLine(e.ToString());
        Console.ResetColor();
      }
      finally
      {
        Console.Write("\r\n\r\nPress any key....");
        Console.ReadKey();
      }
    }

    // Configure the client endpoints.
    public static void ConfigClientEndpoints(string endpt)
    {
      archiveClient = new SvcArchive.ArchiveClient(endpt);
    }
    // Configure the client endpoints.
    public static void SetClientEndpoints(string qendpt)
    {
      queueSystemClient = new SvcQueueSystem.QueueSystemClient(qendpt);
    }
  }

  // Utility class.
  class Helpers
  {
    // Waits for the Project Server Queuing Service to finish archiving the project.
    public static bool WaitForQueue(SvcQueueSystem.QueueMsgType jobType,
      int numJobs, SvcQueueSystem.QueueSystemClient queueSystemClient, DateTime startTime)
    {
      const int maxSeconds2Wait = 50;
      SvcQueueSystem.QueueStatusDataSet queueStatusDs = new SvcQueueSystem.QueueStatusDataSet();

      int timeout = 0; // The number of secs waited.
      Console.WriteLine("Waiting for job" + jobType.ToString());

      SvcQueueSystem.QueueMsgType[] messageTypes = { jobType };
      SvcQueueSystem.JobState[] jobStates = { SvcQueueSystem.JobState.Success };

      while ((timeout &amp;lt; maxSeconds2Wait) &amp;amp;&amp;amp; (queueStatusDs.Status.Count &amp;lt; numJobs))
      {
        System.Threading.Thread.Sleep(1000);

        queueStatusDs = queueSystemClient.ReadMyJobStatus(
          messageTypes,
          jobStates,
          startTime,
          DateTime.Now,
          numJobs,
          true,
          SvcQueueSystem.SortColumn.QueuePosition,
          SvcQueueSystem.SortOrder.LastOrder);

        timeout++;
        Console.Write(".");
      }
      Console.WriteLine();

      if (queueStatusDs.Status.Count == numJobs)
      {
        return true;
      }
      return false;
    }
  }
}

</code>
        </example>
      </Docs>
    </Member>
    <Member MemberName="QueueArchiveProjects">
      <MemberSignature Language="C#" Value="public void QueueArchiveProjects ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void QueueArchiveProjects() cil managed" />
      <MemberSignature Language="DocId" Value="M:WebSvcArchive.Archive.QueueArchiveProjects" />
      <MemberSignature Language="VB.NET" Value="Public Sub QueueArchiveProjects ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void QueueArchiveProjects();" />
      <MemberSignature Language="F#" Value="member this.QueueArchiveProjects : unit -&gt; unit" Usage="archive.QueueArchiveProjects " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>ProjectServerServices</AssemblyName>
        <AssemblyVersion>0.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Web.Services.Protocols.SoapDocumentMethod("http://schemas.microsoft.com/office/project/server/webservices/Archive/QueueArchiveProjects", ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped, RequestNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", ResponseNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", Use=System.Web.Services.Description.SoapBindingUse.Literal)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>Archives all projects that have changed since the last archive action.</summary>
        <remarks>
          <para>
            <b>QueueArchiveProjects</b> is an asynchronous method that sends a message to the Project Server Queuing Service.</para>
          <para>This method is used by the Administrative Backup page (http://ServerName/ProjectServerName/_layouts/pwa/Admin/Backup.aspx) of Project Web App, to archive projects.</para>
          <para>Project Server Permissions</para>
          <list type="table">
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerBackup" />
              </term>
              <description>Allows a user to schedule or perform a backup of Project Server entities. Global permission.</description>
            </item>
          </list>
          <para />
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="QueueArchiveResources">
      <MemberSignature Language="C#" Value="public void QueueArchiveResources (Guid jobUID);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void QueueArchiveResources(valuetype System.Guid jobUID) cil managed" />
      <MemberSignature Language="DocId" Value="M:WebSvcArchive.Archive.QueueArchiveResources(System.Guid)" />
      <MemberSignature Language="VB.NET" Value="Public Sub QueueArchiveResources (jobUID As Guid)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void QueueArchiveResources(Guid jobUID);" />
      <MemberSignature Language="F#" Value="member this.QueueArchiveResources : Guid -&gt; unit" Usage="archive.QueueArchiveResources jobUID" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>ProjectServerServices</AssemblyName>
        <AssemblyVersion>0.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Web.Services.Protocols.SoapDocumentMethod("http://schemas.microsoft.com/office/project/server/webservices/Archive/QueueArchiveResources", ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped, RequestNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", ResponseNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", Use=System.Web.Services.Description.SoapBindingUse.Literal)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="jobUID" Type="System.Guid" />
      </Parameters>
      <Docs>
        <param name="jobUID">The GUID of the queue job.</param>
        <summary>Saves a copy of the enterprise resource tables from the Published database to the Archive database.</summary>
        <remarks>
          <para>
            <b>QueueArchiveResources</b> is an asynchronous method that sends a message to the Project Server Queuing Service.</para>
          <para>Project Server Permissions</para>
          <list type="table">
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerBackup" />
              </term>
              <description>Allows a user to schedule or perform a backup of Project Server entities. Global permission.</description>
            </item>
          </list>
          <para />
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="QueueArchiveSystemSettings">
      <MemberSignature Language="C#" Value="public void QueueArchiveSystemSettings (Guid jobUID);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void QueueArchiveSystemSettings(valuetype System.Guid jobUID) cil managed" />
      <MemberSignature Language="DocId" Value="M:WebSvcArchive.Archive.QueueArchiveSystemSettings(System.Guid)" />
      <MemberSignature Language="VB.NET" Value="Public Sub QueueArchiveSystemSettings (jobUID As Guid)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void QueueArchiveSystemSettings(Guid jobUID);" />
      <MemberSignature Language="F#" Value="member this.QueueArchiveSystemSettings : Guid -&gt; unit" Usage="archive.QueueArchiveSystemSettings jobUID" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>ProjectServerServices</AssemblyName>
        <AssemblyVersion>0.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Web.Services.Protocols.SoapDocumentMethod("http://schemas.microsoft.com/office/project/server/webservices/Archive/QueueArchiveSystemSettings", ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped, RequestNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", ResponseNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", Use=System.Web.Services.Description.SoapBindingUse.Literal)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="jobUID" Type="System.Guid" />
      </Parameters>
      <Docs>
        <param name="jobUID">The GUID of the queue job.</param>
        <summary>Saves a copy of tables with Project Server settings from the Published database to the Archive database.</summary>
        <remarks>
          <para>
            <b>QueueArchiveSystemSettings</b> is an asynchronous method that sends a message to the Project Server Queuing Service.</para>
          <para>Project Server Permissions</para>
          <list type="table">
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerBackup" />
              </term>
              <description>Allows a user to schedule or perform a backup of Project Server entities. Global permission.</description>
            </item>
          </list>
          <para />
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="QueueArchiveViews">
      <MemberSignature Language="C#" Value="public void QueueArchiveViews (Guid jobUID);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void QueueArchiveViews(valuetype System.Guid jobUID) cil managed" />
      <MemberSignature Language="DocId" Value="M:WebSvcArchive.Archive.QueueArchiveViews(System.Guid)" />
      <MemberSignature Language="VB.NET" Value="Public Sub QueueArchiveViews (jobUID As Guid)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void QueueArchiveViews(Guid jobUID);" />
      <MemberSignature Language="F#" Value="member this.QueueArchiveViews : Guid -&gt; unit" Usage="archive.QueueArchiveViews jobUID" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>ProjectServerServices</AssemblyName>
        <AssemblyVersion>0.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Web.Services.Protocols.SoapDocumentMethod("http://schemas.microsoft.com/office/project/server/webservices/Archive/QueueArchiveViews", ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped, RequestNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", ResponseNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", Use=System.Web.Services.Description.SoapBindingUse.Literal)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="jobUID" Type="System.Guid" />
      </Parameters>
      <Docs>
        <param name="jobUID">The GUID of the queue job.</param>
        <summary>Saves a copy of the views tables from the Published database to the Archive database.</summary>
        <remarks>
          <para>
            <b>QueueArchiveViews</b> is an asynchronous method that sends a message to the Project Server Queuing Service.</para>
          <para>Project Server Permissions</para>
          <list type="table">
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerBackup" />
              </term>
              <description>Allows a user to schedule or perform a backup of Project Server entities. Global permission.</description>
            </item>
          </list>
          <para />
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="QueueDeleteArchivedProject">
      <MemberSignature Language="C#" Value="public void QueueDeleteArchivedProject (Guid jobUID, Guid projectUID, Guid archiveUID);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void QueueDeleteArchivedProject(valuetype System.Guid jobUID, valuetype System.Guid projectUID, valuetype System.Guid archiveUID) cil managed" />
      <MemberSignature Language="DocId" Value="M:WebSvcArchive.Archive.QueueDeleteArchivedProject(System.Guid,System.Guid,System.Guid)" />
      <MemberSignature Language="VB.NET" Value="Public Sub QueueDeleteArchivedProject (jobUID As Guid, projectUID As Guid, archiveUID As Guid)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void QueueDeleteArchivedProject(Guid jobUID, Guid projectUID, Guid archiveUID);" />
      <MemberSignature Language="F#" Value="member this.QueueDeleteArchivedProject : Guid * Guid * Guid -&gt; unit" Usage="archive.QueueDeleteArchivedProject (jobUID, projectUID, archiveUID)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>ProjectServerServices</AssemblyName>
        <AssemblyVersion>0.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Web.Services.Protocols.SoapDocumentMethod("http://schemas.microsoft.com/office/project/server/webservices/Archive/QueueDeleteArchivedProject", ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped, RequestNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", ResponseNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", Use=System.Web.Services.Description.SoapBindingUse.Literal)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="jobUID" Type="System.Guid" />
        <Parameter Name="projectUID" Type="System.Guid" />
        <Parameter Name="archiveUID" Type="System.Guid" />
      </Parameters>
      <Docs>
        <param name="jobUID">The GUID of the queue job.</param>
        <param name="projectUID">The GUID of the project to delete in the archive.</param>
        <param name="archiveUID">The GUID of the archive.</param>
        <summary>Deletes the specified project in the Archive database.</summary>
        <remarks>
          <para>
            <b>QueueDeleteArchivedProject</b> is an asynchronous method that sends a message to the Project Server Queuing Service.</para>
          <para>Project Server Permissions</para>
          <list type="table">
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.CleanupProjectServerDatabase" />
              </term>
              <description>Allows a user to delete or move projects. Global permission.</description>
            </item>
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityCategoryPermission.DeleteProject" />
              </term>
              <description>Allows a user to delete the specified projects. Applies only if the current user does not have the <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.CleanupProjectServerDatabase" /> permission. Category permission. </description>
            </item>
          </list>
          <para />
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="QueueRestoreCategories">
      <MemberSignature Language="C#" Value="public void QueueRestoreCategories (Guid jobUID);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void QueueRestoreCategories(valuetype System.Guid jobUID) cil managed" />
      <MemberSignature Language="DocId" Value="M:WebSvcArchive.Archive.QueueRestoreCategories(System.Guid)" />
      <MemberSignature Language="VB.NET" Value="Public Sub QueueRestoreCategories (jobUID As Guid)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void QueueRestoreCategories(Guid jobUID);" />
      <MemberSignature Language="F#" Value="member this.QueueRestoreCategories : Guid -&gt; unit" Usage="archive.QueueRestoreCategories jobUID" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>ProjectServerServices</AssemblyName>
        <AssemblyVersion>0.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Web.Services.Protocols.SoapDocumentMethod("http://schemas.microsoft.com/office/project/server/webservices/Archive/QueueRestoreCategories", ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped, RequestNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", ResponseNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", Use=System.Web.Services.Description.SoapBindingUse.Literal)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="jobUID" Type="System.Guid" />
      </Parameters>
      <Docs>
        <param name="jobUID">The GUID of the queue job.</param>
        <summary>Restores tables related to security categories from the Archive database to the Published database.</summary>
        <remarks>
          <para>Project Server Permissions</para>
          <list type="table">
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerRestore" />
              </term>
              <description>Allows a user to perform a backup of Project Server entities. Global permission.</description>
            </item>
          </list>
          <para />
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="QueueRestoreCustomFields">
      <MemberSignature Language="C#" Value="public void QueueRestoreCustomFields (Guid jobUID);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void QueueRestoreCustomFields(valuetype System.Guid jobUID) cil managed" />
      <MemberSignature Language="DocId" Value="M:WebSvcArchive.Archive.QueueRestoreCustomFields(System.Guid)" />
      <MemberSignature Language="VB.NET" Value="Public Sub QueueRestoreCustomFields (jobUID As Guid)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void QueueRestoreCustomFields(Guid jobUID);" />
      <MemberSignature Language="F#" Value="member this.QueueRestoreCustomFields : Guid -&gt; unit" Usage="archive.QueueRestoreCustomFields jobUID" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>ProjectServerServices</AssemblyName>
        <AssemblyVersion>0.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Web.Services.Protocols.SoapDocumentMethod("http://schemas.microsoft.com/office/project/server/webservices/Archive/QueueRestoreCustomFields", ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped, RequestNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", ResponseNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", Use=System.Web.Services.Description.SoapBindingUse.Literal)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="jobUID" Type="System.Guid" />
      </Parameters>
      <Docs>
        <param name="jobUID">The GUID of the queue job.</param>
        <summary>Restores tables related to enterprise custom fields from the Archive database to the Published database.</summary>
        <remarks>
          <para>
            <b>QueueRestoreCustomFields</b> is an asynchronous method that sends a message to the Project Server Queuing Service.</para>
          <para>Project Server Permissions</para>
          <list type="table">
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerRestore" />
              </term>
              <description>Allows a user to perform a backup of Project Server entities. Global permission.</description>
            </item>
          </list>
          <para />
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="QueueRestoreGlobalProject">
      <MemberSignature Language="C#" Value="public void QueueRestoreGlobalProject (Guid jobUID);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void QueueRestoreGlobalProject(valuetype System.Guid jobUID) cil managed" />
      <MemberSignature Language="DocId" Value="M:WebSvcArchive.Archive.QueueRestoreGlobalProject(System.Guid)" />
      <MemberSignature Language="VB.NET" Value="Public Sub QueueRestoreGlobalProject (jobUID As Guid)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void QueueRestoreGlobalProject(Guid jobUID);" />
      <MemberSignature Language="F#" Value="member this.QueueRestoreGlobalProject : Guid -&gt; unit" Usage="archive.QueueRestoreGlobalProject jobUID" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>ProjectServerServices</AssemblyName>
        <AssemblyVersion>0.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Web.Services.Protocols.SoapDocumentMethod("http://schemas.microsoft.com/office/project/server/webservices/Archive/QueueRestoreGlobalProject", ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped, RequestNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", ResponseNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", Use=System.Web.Services.Description.SoapBindingUse.Literal)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="jobUID" Type="System.Guid" />
      </Parameters>
      <Docs>
        <param name="jobUID">The GUID of the queue job.</param>
        <summary>Restores the enterprise global project from the Archive database to the Published database.</summary>
        <remarks>
          <para>
            <b>QueueRestoreGlobalProject</b> is an asynchronous method that sends a message to the Project Server Queuing Service.</para>
          <para>Project Server Permissions</para>
          <list type="table">
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerRestore" />
              </term>
              <description>Allows a user to perform a backup of Project Server entities. Global permission.</description>
            </item>
          </list>
          <para />
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="QueueRestoreProject">
      <MemberSignature Language="C#" Value="public void QueueRestoreProject (Guid jobUID, Guid projectUID, Guid versionUID);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void QueueRestoreProject(valuetype System.Guid jobUID, valuetype System.Guid projectUID, valuetype System.Guid versionUID) cil managed" />
      <MemberSignature Language="DocId" Value="M:WebSvcArchive.Archive.QueueRestoreProject(System.Guid,System.Guid,System.Guid)" />
      <MemberSignature Language="VB.NET" Value="Public Sub QueueRestoreProject (jobUID As Guid, projectUID As Guid, versionUID As Guid)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void QueueRestoreProject(Guid jobUID, Guid projectUID, Guid versionUID);" />
      <MemberSignature Language="F#" Value="member this.QueueRestoreProject : Guid * Guid * Guid -&gt; unit" Usage="archive.QueueRestoreProject (jobUID, projectUID, versionUID)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>ProjectServerServices</AssemblyName>
        <AssemblyVersion>0.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Web.Services.Protocols.SoapDocumentMethod("http://schemas.microsoft.com/office/project/server/webservices/Archive/QueueRestoreProject", ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped, RequestNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", ResponseNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", Use=System.Web.Services.Description.SoapBindingUse.Literal)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="jobUID" Type="System.Guid" />
        <Parameter Name="projectUID" Type="System.Guid" />
        <Parameter Name="versionUID" Type="System.Guid" />
      </Parameters>
      <Docs>
        <param name="jobUID">The GUID of the queue job.</param>
        <param name="projectUID">The GUID of the archived project.</param>
        <param name="versionUID">The GUID of the project version.</param>
        <summary>Restores the specified archived project version from the Archive database to the Published database</summary>
        <remarks>
          <para>
            <b>QueueRestoreProject</b> is an asynchronous method that sends a message to the Project Server Queuing Service. The <paramref name="versionUID" /> is the value from the <b>QueueArchiveProject</b> call that created the archived project version.</para>
          <para>Project Server Permissions</para>
          <list type="table">
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerRestore" />
              </term>
              <description>Allows a user to perform a backup of Project Server entities. Global permission.</description>
            </item>
          </list>
          <para />
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="QueueRestoreResources">
      <MemberSignature Language="C#" Value="public void QueueRestoreResources (Guid jobUID);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void QueueRestoreResources(valuetype System.Guid jobUID) cil managed" />
      <MemberSignature Language="DocId" Value="M:WebSvcArchive.Archive.QueueRestoreResources(System.Guid)" />
      <MemberSignature Language="VB.NET" Value="Public Sub QueueRestoreResources (jobUID As Guid)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void QueueRestoreResources(Guid jobUID);" />
      <MemberSignature Language="F#" Value="member this.QueueRestoreResources : Guid -&gt; unit" Usage="archive.QueueRestoreResources jobUID" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>ProjectServerServices</AssemblyName>
        <AssemblyVersion>0.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Web.Services.Protocols.SoapDocumentMethod("http://schemas.microsoft.com/office/project/server/webservices/Archive/QueueRestoreResources", ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped, RequestNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", ResponseNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", Use=System.Web.Services.Description.SoapBindingUse.Literal)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="jobUID" Type="System.Guid" />
      </Parameters>
      <Docs>
        <param name="jobUID">The GUID of the queue job.</param>
        <summary>Restores archived enterprise resources from the Archive database to the Published database.</summary>
        <remarks>
          <para>
            <b>QueueRestoreResource</b> is an asynchronous method that sends a message to the Project Server Queuing Service.</para>
          <para>Project Server Permissions</para>
          <list type="table">
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerRestore" />
              </term>
              <description>Allows a user to perform a backup of Project Server entities. Global permission.</description>
            </item>
          </list>
          <para />
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="QueueRestoreSystemSettings">
      <MemberSignature Language="C#" Value="public void QueueRestoreSystemSettings (Guid jobUID);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void QueueRestoreSystemSettings(valuetype System.Guid jobUID) cil managed" />
      <MemberSignature Language="DocId" Value="M:WebSvcArchive.Archive.QueueRestoreSystemSettings(System.Guid)" />
      <MemberSignature Language="VB.NET" Value="Public Sub QueueRestoreSystemSettings (jobUID As Guid)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void QueueRestoreSystemSettings(Guid jobUID);" />
      <MemberSignature Language="F#" Value="member this.QueueRestoreSystemSettings : Guid -&gt; unit" Usage="archive.QueueRestoreSystemSettings jobUID" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>ProjectServerServices</AssemblyName>
        <AssemblyVersion>0.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Web.Services.Protocols.SoapDocumentMethod("http://schemas.microsoft.com/office/project/server/webservices/Archive/QueueRestoreSystemSettings", ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped, RequestNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", ResponseNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", Use=System.Web.Services.Description.SoapBindingUse.Literal)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="jobUID" Type="System.Guid" />
      </Parameters>
      <Docs>
        <param name="jobUID">The GUID of the queue job.</param>
        <summary>Restores Project Server system settings from the Archive database to the Published database.</summary>
        <remarks>
          <para>
            <b>QueueRestoreSystemSettings</b> is an asynchronous method that sends a message to the Project Server Queuing Service.</para>
          <para>Project Server Permissions</para>
          <list type="table">
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerRestore" />
              </term>
              <description>Allows a user to perform a backup of Project Server entities. Global permission.</description>
            </item>
          </list>
          <para />
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="QueueRestoreViews">
      <MemberSignature Language="C#" Value="public void QueueRestoreViews (Guid jobUID);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void QueueRestoreViews(valuetype System.Guid jobUID) cil managed" />
      <MemberSignature Language="DocId" Value="M:WebSvcArchive.Archive.QueueRestoreViews(System.Guid)" />
      <MemberSignature Language="VB.NET" Value="Public Sub QueueRestoreViews (jobUID As Guid)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void QueueRestoreViews(Guid jobUID);" />
      <MemberSignature Language="F#" Value="member this.QueueRestoreViews : Guid -&gt; unit" Usage="archive.QueueRestoreViews jobUID" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>ProjectServerServices</AssemblyName>
        <AssemblyVersion>0.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Web.Services.Protocols.SoapDocumentMethod("http://schemas.microsoft.com/office/project/server/webservices/Archive/QueueRestoreViews", ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped, RequestNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", ResponseNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", Use=System.Web.Services.Description.SoapBindingUse.Literal)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="jobUID" Type="System.Guid" />
      </Parameters>
      <Docs>
        <param name="jobUID">The GUID of the queue job.</param>
        <summary>Restores archived views from the Archive database to the Published database.</summary>
        <remarks>
          <para>
            <b>QueueRestoreViews</b> is an asynchronous method that sends a message to the Project Server Queuing Service.</para>
          <para>Project Server Permissions</para>
          <list type="table">
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerRestore" />
              </term>
              <description>Allows a user to perform a backup of Project Server entities. Global permission.</description>
            </item>
          </list>
          <para />
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="QueueScheduleArchives">
      <MemberSignature Language="C#" Value="public void QueueScheduleArchives (WebSvcArchive.ArchiveOpcode opCode);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void QueueScheduleArchives(valuetype WebSvcArchive.ArchiveOpcode opCode) cil managed" />
      <MemberSignature Language="DocId" Value="M:WebSvcArchive.Archive.QueueScheduleArchives(WebSvcArchive.ArchiveOpcode)" />
      <MemberSignature Language="VB.NET" Value="Public Sub QueueScheduleArchives (opCode As ArchiveOpcode)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void QueueScheduleArchives(WebSvcArchive::ArchiveOpcode opCode);" />
      <MemberSignature Language="F#" Value="member this.QueueScheduleArchives : WebSvcArchive.ArchiveOpcode -&gt; unit" Usage="archive.QueueScheduleArchives opCode" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>ProjectServerServices</AssemblyName>
        <AssemblyVersion>0.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Web.Services.Protocols.SoapDocumentMethod("http://schemas.microsoft.com/office/project/server/webservices/Archive/QueueScheduleArchives", ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped, RequestNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", ResponseNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", Use=System.Web.Services.Description.SoapBindingUse.Literal)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="opCode" Type="WebSvcArchive.ArchiveOpcode" />
      </Parameters>
      <Docs>
        <param name="opCode">The operation code for the archive schedule.</param>
        <summary>Sets the archive schedule.</summary>
        <remarks>
          <para>
            <b>QueueScheduleArchives</b> is an asynchronous method that sends a message to the Project Server Queuing Service.</para>
          <para>Project Server Permissions</para>
          <list type="table">
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerBackup" />
              </term>
              <description>Allows a user to schedule or perform a backup of Project Server entities. Global permission.</description>
            </item>
          </list>
          <para />
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="ReadArchivedProjectsList">
      <MemberSignature Language="C#" Value="public WebSvcArchive.ArchivedProjectsDataSet ReadArchivedProjectsList ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class WebSvcArchive.ArchivedProjectsDataSet ReadArchivedProjectsList() cil managed" />
      <MemberSignature Language="DocId" Value="M:WebSvcArchive.Archive.ReadArchivedProjectsList" />
      <MemberSignature Language="VB.NET" Value="Public Function ReadArchivedProjectsList () As ArchivedProjectsDataSet" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; WebSvcArchive::ArchivedProjectsDataSet ^ ReadArchivedProjectsList();" />
      <MemberSignature Language="F#" Value="member this.ReadArchivedProjectsList : unit -&gt; WebSvcArchive.ArchivedProjectsDataSet" Usage="archive.ReadArchivedProjectsList " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>ProjectServerServices</AssemblyName>
        <AssemblyVersion>0.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Web.Services.Protocols.SoapDocumentMethod("http://schemas.microsoft.com/office/project/server/webservices/Archive/ReadArchivedProjectsList", ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped, RequestNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", ResponseNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", Use=System.Web.Services.Description.SoapBindingUse.Literal)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>WebSvcArchive.ArchivedProjectsDataSet</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>Gets a list of archived projects; the list includes the project name and GUID.</summary>
        <returns>To be added.</returns>
        <remarks>
          <para>
            <b>Note</b>: This method retrieves draft projects and published projects.</para>
          <para>Project Server Permissions</para>
          <list type="table">
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.CleanupProjectServerDatabase" />
              </term>
              <description>Allows a user to delete or move projects. Global permission.</description>
            </item>
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerBackup" />
              </term>
              <description>Allows a user to schedule or perform a backup of Project Server entities. Global permission.</description>
            </item>
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerRestore" />
              </term>
              <description>Allows a user to perform a backup of Project Server entities. Global permission.</description>
            </item>
          </list>
          <para />
        </remarks>
        <example>
          <para>The following example saves a copy of the specified project from the Published database to the Archive database, and retrieves the list of archived projects </para>
          <para>For information about running this code sample, see Prerequisites for WCF-Based Code Samples.</para>
          <code>
using System;
using System.IO;
using System.ServiceModel;
using System.Text;
using PSLibrary = Microsoft.Office.Project.Server.Library;

namespace Microsoft.SDK.Project.Samples.ReadArchivedProjectsList
{
  class Program
  {
    private const string ENDPOINT = "basicHttp_Archive";
    private const string ENDPOINT_Q = "basicHttp_QueueSystem";
    private const string VERSION_DESCRIPTION = "2010-01-19 14:52:30";
    private const string PID = "56B5C90D-28C0-42A1-A2CF-8BC205F062BA";
    private const string OUTPUT_FILES = @"C:\Projects\Samples\Output\";

    private const int RETENTION_POLICY = -2;

    private static SvcArchive.ArchiveClient archiveClient;
    private static SvcQueueSystem.QueueSystemClient queueSystemClient;
    private static string outFilePath;

    private static int numProjects;

    static void Main(string[] args)
    {
      try
      {
        Guid jobUID = Guid.NewGuid();
        Guid projectUID = new Guid(PID);
        Guid archivedProjectUID = Guid.NewGuid();
        DateTime startTime = DateTime.Now;
        numProjects = 1;

        // Use the endpoints that are defined in app.config to configure the client.
        SetClientEndpoints(ENDPOINT_Q);
        ConfigClientEndpoints(ENDPOINT);

        // Assign the path where the output XML file will be saved.
        outFilePath = OUTPUT_FILES + "ArchivedProjectsList.xml";

        // Queue archive project
        Guid projectVersionUID = archiveClient.QueueArchiveProject(
          jobUID, projectUID, archivedProjectUID, VERSION_DESCRIPTION, RETENTION_POLICY, true);

        Helpers.WaitForQueue(SvcQueueSystem.QueueMsgType.ProjectArchive, numProjects,
          queueSystemClient, startTime);

        Console.WriteLine("Projects archived successfully");

        Console.WriteLine("Retrieving the list of archived projects...");

        // Create a dataset.
        SvcArchive.ArchivedProjectsDataSet archivedProjectsDs =
            new SvcArchive.ArchivedProjectsDataSet();

        // Assign the datasource to the dataset.
        archivedProjectsDs = archiveClient.ReadArchivedProjectsList();
        archivedProjectsDs.WriteXml(outFilePath);

        // Get the count of projects.
        Console.WriteLine("Number of archived projects: {0}",
            archivedProjectsDs.Projects.Count.ToString());
        archiveClient.Close();

        // Write the list of projects to an XML file.
        Console.WriteLine("\nSee XML output of the ArchivedProjectsDataSet at {0}",
            outFilePath);
      }
      catch (CommunicationException e)
      {
        Console.ForegroundColor = ConsoleColor.Red;
        Console.WriteLine("\n***System.ServiceModel.CommunicationException:");
        Console.WriteLine(e.ToString());
        Console.ResetColor();
      }
      finally
      {
        Console.Write("\r\n\r\nPress any key....");
        Console.ReadKey();
      }
    }

    // Configure the client endpoints.
    public static void ConfigClientEndpoints(string endpt)
    {
      archiveClient = new SvcArchive.ArchiveClient(endpt);
    }
    // Configure the client endpoints.
    public static void SetClientEndpoints(string qendpt)
    {
      queueSystemClient = new SvcQueueSystem.QueueSystemClient(qendpt);
    }
  }

  // Utility class.
  class Helpers
  {
    // Waits for the Project Server Queuing Service to finish archiving the project.
    public static bool WaitForQueue(SvcQueueSystem.QueueMsgType jobType,
      int numJobs, SvcQueueSystem.QueueSystemClient queueSystemClient, DateTime startTime)
    {
      const int maxSeconds2Wait = 50;
      SvcQueueSystem.QueueStatusDataSet queueStatusDs = new SvcQueueSystem.QueueStatusDataSet();

      int timeout = 0; // The number of secs waited.
      Console.WriteLine("Waiting for job" + jobType.ToString());

      SvcQueueSystem.QueueMsgType[] messageTypes = { jobType };
      SvcQueueSystem.JobState[] jobStates = { SvcQueueSystem.JobState.Success };

      while ((timeout &amp;lt; maxSeconds2Wait) &amp;amp;&amp;amp; (queueStatusDs.Status.Count &amp;lt; numJobs))
      {
        System.Threading.Thread.Sleep(1000);

        queueStatusDs = queueSystemClient.ReadMyJobStatus(
          messageTypes,
          jobStates,
          startTime,
          DateTime.Now,
          numJobs,
          true,
          SvcQueueSystem.SortColumn.QueuePosition,
          SvcQueueSystem.SortOrder.LastOrder);

        timeout++;
        Console.Write(".");
      }
      Console.WriteLine();

      if (queueStatusDs.Status.Count == numJobs)
      {
        return true;
      }
      return false;
    }
  }
}

</code>
        </example>
      </Docs>
    </Member>
    <Member MemberName="ReadArchiveSchedule">
      <MemberSignature Language="C#" Value="public WebSvcArchive.ArchiveScheduleDataSet ReadArchiveSchedule ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class WebSvcArchive.ArchiveScheduleDataSet ReadArchiveSchedule() cil managed" />
      <MemberSignature Language="DocId" Value="M:WebSvcArchive.Archive.ReadArchiveSchedule" />
      <MemberSignature Language="VB.NET" Value="Public Function ReadArchiveSchedule () As ArchiveScheduleDataSet" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; WebSvcArchive::ArchiveScheduleDataSet ^ ReadArchiveSchedule();" />
      <MemberSignature Language="F#" Value="member this.ReadArchiveSchedule : unit -&gt; WebSvcArchive.ArchiveScheduleDataSet" Usage="archive.ReadArchiveSchedule " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>ProjectServerServices</AssemblyName>
        <AssemblyVersion>0.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Web.Services.Protocols.SoapDocumentMethod("http://schemas.microsoft.com/office/project/server/webservices/Archive/ReadArchiveSchedule", ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped, RequestNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", ResponseNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", Use=System.Web.Services.Description.SoapBindingUse.Literal)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>WebSvcArchive.ArchiveScheduleDataSet</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>Gets information about the archive schedule.</summary>
        <returns>To be added.</returns>
        <remarks>
          <para>Project Server Permissions</para>
          <list type="table">
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerBackup" />
              </term>
              <description>Allows a user to schedule or perform a backup of Project Server entities. Global permission.</description>
            </item>
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerRestore" />
              </term>
              <description>Allows a user to perform a backup of Project Server entities. Global permission.</description>
            </item>
          </list>
          <para />
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="ReadProjectArchiveRetentionSetting">
      <MemberSignature Language="C#" Value="public WebSvcArchive.ProjectArchiveRetentionDataSet ReadProjectArchiveRetentionSetting ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class WebSvcArchive.ProjectArchiveRetentionDataSet ReadProjectArchiveRetentionSetting() cil managed" />
      <MemberSignature Language="DocId" Value="M:WebSvcArchive.Archive.ReadProjectArchiveRetentionSetting" />
      <MemberSignature Language="VB.NET" Value="Public Function ReadProjectArchiveRetentionSetting () As ProjectArchiveRetentionDataSet" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; WebSvcArchive::ProjectArchiveRetentionDataSet ^ ReadProjectArchiveRetentionSetting();" />
      <MemberSignature Language="F#" Value="member this.ReadProjectArchiveRetentionSetting : unit -&gt; WebSvcArchive.ProjectArchiveRetentionDataSet" Usage="archive.ReadProjectArchiveRetentionSetting " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>ProjectServerServices</AssemblyName>
        <AssemblyVersion>0.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Web.Services.Protocols.SoapDocumentMethod("http://schemas.microsoft.com/office/project/server/webservices/Archive/ReadProjectArchiveRetentionSetting", ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped, RequestNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", ResponseNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", Use=System.Web.Services.Description.SoapBindingUse.Literal)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>WebSvcArchive.ProjectArchiveRetentionDataSet</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>Gets the default Project Server archive retention setting.</summary>
        <returns>To be added.</returns>
        <remarks>
          <para>Project Server Permissions</para>
          <list type="table">
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerBackup" />
              </term>
              <description>Allows a user to schedule or perform a backup of Project Server entities. Global permission.</description>
            </item>
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerRestore" />
              </term>
              <description>Allows a user to perform a backup of Project Server entities. Global permission.</description>
            </item>
          </list>
          <para />
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="UpdateArchiveSchedule">
      <MemberSignature Language="C#" Value="public void UpdateArchiveSchedule (WebSvcArchive.ArchiveScheduleDataSet scheduleDataSet);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void UpdateArchiveSchedule(class WebSvcArchive.ArchiveScheduleDataSet scheduleDataSet) cil managed" />
      <MemberSignature Language="DocId" Value="M:WebSvcArchive.Archive.UpdateArchiveSchedule(WebSvcArchive.ArchiveScheduleDataSet)" />
      <MemberSignature Language="VB.NET" Value="Public Sub UpdateArchiveSchedule (scheduleDataSet As ArchiveScheduleDataSet)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void UpdateArchiveSchedule(WebSvcArchive::ArchiveScheduleDataSet ^ scheduleDataSet);" />
      <MemberSignature Language="F#" Value="member this.UpdateArchiveSchedule : WebSvcArchive.ArchiveScheduleDataSet -&gt; unit" Usage="archive.UpdateArchiveSchedule scheduleDataSet" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>ProjectServerServices</AssemblyName>
        <AssemblyVersion>0.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Web.Services.Protocols.SoapDocumentMethod("http://schemas.microsoft.com/office/project/server/webservices/Archive/UpdateArchiveSchedule", ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped, RequestNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", ResponseNamespace="http://schemas.microsoft.com/office/project/server/webservices/Archive/", Use=System.Web.Services.Description.SoapBindingUse.Literal)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="scheduleDataSet" Type="WebSvcArchive.ArchiveScheduleDataSet" />
      </Parameters>
      <Docs>
        <param name="scheduleDataSet">Contains the archive schedule information.</param>
        <summary>Updates the archive schedule.</summary>
        <remarks>
          <para>Project Server Permissions</para>
          <list type="table">
            <item>
              <term>
                <see cref="F:Microsoft.Office.Project.Server.Library.PSSecurityGlobalPermission.ManageProjectServerBackup" />
              </term>
              <description>Allows a user to schedule or perform a backup of Project Server entities. Global permission.</description>
            </item>
          </list>
          <para />
        </remarks>
      </Docs>
    </Member>
  </Members>
</Type>